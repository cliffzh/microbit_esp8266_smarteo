<xml xmlns="https://developers.google.com/blockly/xml"><block type="pxt-on-start" id="7PGAPOK9fFT%8xJ#BOhT" x="0" y="0"><statement name="HANDLER"><block type="typescript_statement" id="k%l+_C21iR)qYx#hY;a?" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="namespace ESP8266Smarteo {" line1="    " line2="    function sendAT(command : string, wait : number = 0) {" line3="        serial.writeString(`${command}\u000D\u000A`)" line4="        basic.pause(wait)" line5="    }" line6="" line7="    function resetESP() {" line8="        sendAT(&quot;AT+RESTORE&quot;, 1000) // restore to factory settings" line9="        sendAT(&quot;AT+RST&quot;, 1000) // reset the module" line10="        let response = serial.readString()" line11="        console.log(response)" line12="        sendAT(&quot;AT+CWMODE=1&quot;, 500) // set to station mode" line13="        basic.showNumber(1)" line14="        basic.pause(3000)" line15="    }" line16="    " line17="    /**" line18="     * Initialize ESP8266 module" line19="     */" line20="    //% block='set ESP8266 RX %rx TX %tx Baudrate %baudrate'" line21="    //% tx.defl='SerialPin.P14'" line22="    //% rx.defl='SerialPin.P0'" line23="    //% baudrate.defl='baudrate.BaudRate115200'" line24="    export function initesp8266(tx : SerialPin, rx : SerialPin, baudrate : BaudRate) {" line25="        serial.redirect(tx, rx, BaudRate.BaudRate115200)" line26="        basic.showNumber(0)" line27="        basic.pause(100)" line28="        serial.setTxBufferSize(128)" line29="        serial.setRxBufferSize(128)" line30="        resetESP()" line31="    }" line32="" line33="    /**" line34="     * Connect to Wifi router" line35="     */" line36="    //% block='Connect Wifi SSID %ssid password %password ip address %ip_address'" line37="    //% ssid.defl='Smarteo'" line38="    //% password.defl='%Smarteo123'" line39="    //% ip_address.defl='192.168.1.30'" line40="    export function connectesp8266(ssid : string, password : string, ip_address : string) {" line41="        sendAT(`AT+CWJAP=&quot;${ssid}&quot;,&quot;${password}&quot;`)" line42="        let response2 = serial.readString()" line43="        console.log(response2)" line44="        basic.showNumber(2)" line45="        basic.pause(2000)" line46="        sendAT(`AT+CIPSTA=&quot;${ip_address}&quot;`, 1000)" line47="        basic.showNumber(3)" line48="        basic.pause(2000)" line49="    }" line50=" }" numlines="51"></mutation></block></statement></block></xml>